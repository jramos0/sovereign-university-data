---
term: ПОДПИСЬ АДАПТЕРА

---
Криптографический метод, позволяющий объединить подлинную подпись с дополнительной подписью (так называемой "подписью-адаптером") для раскрытия секретного фрагмента данных. Этот метод работает таким образом, что знание двух элементов среди подлинной подписи, подписи-адаптера и секрета позволяет вычислить недостающий третий элемент. Одно из интересных свойств этого метода заключается в том, что если мы знаем адаптерную подпись нашего партнера и конкретную точку на эллиптической кривой, связанную с секретом, использованным для расчета этой адаптерной подписи, мы можем вывести свою собственную адаптерную подпись, которая будет соответствовать тому же секрету, не имея прямого доступа к самому секрету. При обмене между двумя заинтересованными сторонами, которые не доверяют друг другу, эта техника позволяет одновременно раскрыть две конфиденциальные части информации между участниками. Этот процесс устраняет необходимость в доверии при мгновенных транзакциях, таких как обмен монетами или атомный обмен. Давайте рассмотрим пример, чтобы лучше понять его. Алиса и Боб хотят отправить друг другу 1 BTC, но они не доверяют друг другу. Поэтому они будут использовать адаптерные подписи, чтобы отменить необходимость доверия к другой стороне в этом обмене (таким образом, это будет "атомарный" обмен). Они действуют следующим образом:


- Алиса инициирует этот атомарный обмен. Она создает транзакцию $m_A$, которая отправляет 1 BTC Бобу. Она создает подпись $s_A$, которая подтверждает эту транзакцию, используя свой закрытый ключ $p_A$ ($P_A = p_A \cdot G$), а также используя nonce $n_A$ и секрет $t$ ($N_A = n_A \cdot G$ и $T = t \cdot G$):

$$s_A = n_A + t + H(N_A + T \parallel P_A \parallel m_A) \cdot p_A$$

&nbsp;


- Алиса вычисляет подпись адаптера $s_A'$ из секрета $t$ и своей реальной подписи $s_A$:

$$s_A' = s_A - t$$

&nbsp;


- Алиса отправляет Бобу свою адаптерную подпись $s_A'$, свою неподписанную транзакцию $m_A$, точку, соответствующую секрету $T$, и точку, соответствующую нецелю $N_A$. Мы называем эти части информации "адаптером". Обратите внимание, что, имея только эту информацию, Боб не сможет восстановить BTC Алисы.
- Однако Боб может убедиться, что Алиса его не обманывает. Для этого он проверяет, что подпись адаптера Алисы $s_A'$ соответствует обещанной транзакции $m_A$. Если следующее уравнение верно, то он убежден, что подпись адаптера Алисы действительна:

$$s_A' \cdot G = N_A + H(N_A + T \parallel P_A \parallel m_A) \cdot P_A$$

&nbsp;


- Эта проверка дает Бобу гарантии от Алисы, так что он может спокойно продолжать процесс атомарного обмена. Затем он создаст собственную транзакцию $m_B$, отправив Алисе 1 BTC, и собственную адаптерную подпись $s_B'$, которая будет связана с тем же секретом $t$, который пока знает только Алиса (Боб не знает этого значения $t$, а только соответствующую ему точку $T$, которую ему предоставила Алиса): $$s_B' = n_B + H(N_B + T \parallel P_B \parallel m_B) \cdot p_B$$

&nbsp;


- Боб отправляет Алисе свою адаптерную подпись $s_B'$, неподписанную транзакцию $m_B$, точку, соответствующую секрету $T$, и точку, соответствующую несекрету $N_B$. Теперь Алиса может объединить адаптерную подпись Боба $s_B'$ с секретом $t$, который известен только ей, чтобы вычислить действительную подпись $s_B$ для транзакции $m_B$, которая отправляет ей BTC Боба:

$$s_B = s_B' + t$$

&nbsp;

$$(s_B' + t)\cdot G = N_B + T + H(N_B + T \parallel P_B \parallel m_B)\cdot P_B$$

&nbsp;


- Алиса транслирует эту подписанную транзакцию $m_B$ в блокчейн Биткойна, чтобы вернуть BTC, которые ей обещал Боб. Боб узнает об этой транзакции в блокчейне. Таким образом, он может извлечь подпись $s_B = s_B' + t$. Из этой информации Боб может выудить нужный ему знаменитый секрет $t$:

$$t = (s_B' + t) - s_B' = s_B - s_B'$$

&nbsp;


- Однако этот секрет $t$ был единственной недостающей информацией для Боба, чтобы создать действительную подпись $s_A$ из адаптерной подписи Алисы $s_A'$, которая позволит ему подтвердить транзакцию $m_A$, отправив BTC от Алисы к Бобу. Затем он вычисляет $s_A$ и транслирует транзакцию $m_A$ по очереди: $$s_A = s_A' + t$$

&nbsp;

$$(s_A' + t)\cdot G = N_A + T + H(N_A + T \parallel P_A \parallel m_A) \cdot P_A$$