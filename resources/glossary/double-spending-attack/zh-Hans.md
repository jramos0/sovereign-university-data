---
term: 双重消费（攻击）

---
一种攻击，恶意用户试图多次使用相同的 UTXO（*未花费交易输出*），以牺牲交易相关方的利益来敛财。原则上，一旦一笔交易在一个区块中得到确认并被添加到区块链中，这些比特币的使用就会被永久记录下来，从而防止相同比特币的进一步消费。防止重复消费甚至是区块链的主要用途。

在双重消费攻击中，攻击者首先与商家进行合法交易，然后用相同的硬币创建第二笔竞争交易，要么将硬币寄回给自己以收回金额，要么用它们从不同的商家购买另一种商品或服务。

这种攻击主要有两种情况。第一种，也是对攻击者来说最简单的一种，就是在合法交易被纳入区块之前执行欺诈交易。为了确保欺诈性交易首先得到确认，攻击者会将比合法交易高得多的交易费与欺诈性交易联系起来。这是一种欺诈性 RBF。只有当商家同意在 "zeroconf"（即不对支付交易进行任何确认）中完成销售时，这种情况才有可能发生。因此，强烈建议在将交易视为不可变之前等待几次确认。第二种情况要复杂得多，即 51% 攻击。如果攻击者控制了网络的大部分计算能力，他们就可以挖掘出一条与包含合法交易的链相竞争的链，但其中也包括他们的欺诈交易。当商家接受了这笔交易，而攻击者又成功创建了一条比合法交易链更长（累积工作量更多）的交易链时，他们就可以广播他们的欺诈交易链，网络节点会将其视为有效交易链。