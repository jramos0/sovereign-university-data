---
term: DOPPIA SPESA (ATTACCO)

---
Un attacco in cui un utente malintenzionato tenta di utilizzare lo stesso UTXO (*Unspent Transaction Output*) più di una volta per arricchirsi a spese delle parti coinvolte nelle transazioni. In linea di principio, una volta che una transazione viene confermata in un blocco e aggiunta alla blockchain, l'uso di quei bitcoin viene registrato in modo permanente, impedendo qualsiasi ulteriore spesa degli stessi bitcoin. La prevenzione della doppia spesa è addirittura l'utilità principale della blockchain.

Nel contesto di un attacco a doppia spesa, l'attaccante effettua prima una transazione legittima con un commerciante, quindi crea una seconda transazione concorrente spendendo le stesse monete, rispedendole a se stesso per recuperare l'importo o utilizzandole per acquistare un altro bene o servizio da un commerciante diverso.

Esistono due scenari principali che possono consentire questo attacco. Il primo, il più semplice per l'attaccante, prevede l'esecuzione della transazione fraudolenta prima che la transazione legittima sia inclusa in un blocco. Per assicurarsi che la transazione fraudolenta venga confermata per prima, l'aggressore associa ad essa commissioni di transazione significativamente più elevate rispetto alla transazione legittima. Si tratta di una sorta di RBF fraudolenta. Questo scenario è possibile solo se il commerciante accetta di finalizzare la vendita in "zeroconf", ovvero senza alcuna conferma della transazione di pagamento. Per questo motivo si raccomanda vivamente di attendere diverse conferme prima di considerare una transazione come immutabile. Il secondo scenario, molto più complesso, è quello di un attacco al 51%. Se l'attaccante controlla una parte significativa della potenza di calcolo della rete, può creare una catena concorrente a quella che contiene la transazione legittima, ma che include la sua transazione fraudolenta. Quando il commerciante ha accettato la vendita e l'attaccante è riuscito a creare una catena più lunga (con più lavoro accumulato) di quella legittima, può trasmettere la sua catena fraudolenta, che verrà riconosciuta dai nodi della rete come quella valida.