---
term: DUPLICAÇÃO DAS DESPESAS (ATAQUE)

---
Um ataque em que um utilizador malicioso tenta utilizar o mesmo UTXO (*Unspent Transaction Output*) mais do que uma vez para se enriquecer à custa das partes envolvidas nas transacções. Em princípio, uma vez que uma transação é confirmada num bloco e adicionada à cadeia de blocos, a utilização desses bitcoins é registada permanentemente, impedindo qualquer outro gasto dos mesmos bitcoins. A prevenção de gastos duplos é mesmo a principal utilidade da cadeia de blocos.

No contexto de um ataque de gasto duplo, o atacante faz primeiro uma transação legítima com um comerciante e depois cria uma segunda transação concorrente gastando as mesmas moedas, quer enviando-as de volta para si próprio para recuperar o montante, quer utilizando-as para comprar outro bem ou serviço a um comerciante diferente.

Existem dois cenários principais que podem permitir este ataque. O primeiro, e mais simples para o atacante, envolve a execução da transação fraudulenta antes de a transação legítima ser incluída num bloco. Para garantir que a sua transação fraudulenta é confirmada primeiro, o atacante associa-lhe taxas de transação significativamente mais elevadas do que à transação legítima. Trata-se de uma espécie de RBF fraudulenta. Este cenário só é possível se o comerciante concordar em finalizar a venda em "zeroconf", ou seja, sem quaisquer confirmações para a transação de pagamento. É por isso que se recomenda vivamente esperar várias confirmações antes de considerar uma transação como imutável. O segundo cenário, muito mais complexo, é o de um ataque de 51%. Se o atacante controlar uma parte significativa do poder de computação da rede, pode extrair uma cadeia concorrente da que contém a transação legítima, mas que inclui a sua transação fraudulenta. Quando o comerciante tiver aceite a venda e o atacante tiver conseguido criar uma cadeia mais longa (com mais trabalho acumulado) do que a cadeia legítima, pode então difundir a sua cadeia fraudulenta, que será reconhecida pelos nós da rede como a cadeia válida.