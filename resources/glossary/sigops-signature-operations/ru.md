---
term: SIGOPS (СИГНАТУРНЫЕ ОПЕРАЦИИ)

---
Относится к операциям с цифровой подписью, необходимым для подтверждения транзакций. Каждая транзакция Bitcoin может содержать несколько входов, каждый из которых может требовать одной или нескольких подписей, чтобы считаться действительным. Проверка этих подписей осуществляется с помощью специальных опкодов, называемых "sigops". В частности, к ним относятся `OP_CHECKSIG`, `OP_CHECKSIGVERIFY`, `OP_CHECKMULTISIG` и `OP_CHECKMULTISIGVERIFY`. Эти операции накладывают определенную нагрузку на узлы сети, которые должны их проверять. Чтобы предотвратить DoS-атаки за счет искусственного увеличения количества sigops, протокол накладывает ограничение на количество sigops, разрешенных на блок, чтобы нагрузка на узлы при проверке оставалась управляемой. В настоящее время это ограничение составляет не более 80 000 сигопов на блок. Для подсчета узлы следуют следующим правилам:

В `scriptPubKey`, `OP_CHECKSIG` и `OP_CHECKSIGVERIFY` считаются за 4 сигопа. Опкоды `OP_CHECKMULTISIG` и `OP_CHECKMULTISIGVERIFY` составляют 80 сигопов. Действительно, при подсчете эти операции умножаются на 4, если они не являются частью SegWit-входа (для P2WPKH количество сигопов будет равно 1);

В `redeemScript` опкоды `OP_CHECKSIG` и `OP_CHECKSIGVERIFY` также считаются за 4 сигопа, `OP_CHECKMULTISIG` и `OP_CHECKMULTISIGVERIFY` учитываются как `4n`, если они предшествуют `OP_n`, или 80 сигопов в противном случае;

Для `witnessScript`, `OP_CHECKSIG` и `OP_CHECKSIGVERIFY` стоят 1 сигпоп, `OP_CHECKMULTISIG` и `OP_CHECKMULTISIGVERIFY` считаются как `n`, если они введены `OP_n`, или 20 сигпопов в противном случае;

В скриптах Taproot sigops обрабатываются иначе, чем в традиционных скриптах. Вместо прямого подсчета каждой операции подписи Taproot вводит бюджет sigops для каждого входа транзакции, который пропорционален размеру этого входа. Этот бюджет составляет 50 sigops плюс размер байта свидетеля входа. Каждая операция подписи уменьшает этот бюджет на 50. Если в результате выполнения операции подписи бюджет опускается ниже нуля, скрипт считается недействительным. Этот метод позволяет сделать скрипты Taproot более гибкими, сохраняя при этом защиту от потенциальных злоупотреблений, связанных с сигопами, поскольку напрямую связывает их с весом входных данных. Таким образом, скрипты Taproot не включены в ограничение 80 000 sigops на блок.